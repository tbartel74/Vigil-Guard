# Heuristics Service Configuration
# Copy to .env and adjust values as needed

# Server Configuration
PORT=5005
NODE_ENV=production
LOG_LEVEL=info

# Detection Weights (MUST sum to 1.0)
WEIGHT_OBFUSCATION=0.30
WEIGHT_STRUCTURE=0.25
WEIGHT_WHISPER=0.30
WEIGHT_ENTROPY=0.15

# Threat Thresholds
THRESHOLD_LOW_MAX=39
THRESHOLD_MEDIUM_MAX=69

# Obfuscation Detection
ZERO_WIDTH_THRESHOLD=2
HOMOGLYPH_THRESHOLD=3
MIXED_SCRIPT_THRESHOLD=2
SPACING_ANOMALY_RATIO=0.1

# Structure Detection
CODE_FENCE_THRESHOLD=3
BOUNDARY_THRESHOLD=5
NEWLINE_THRESHOLD=10
SEGMENTATION_RATIO=0.3

# Whisper/Narrative Detection
WHISPER_WEIGHT_MULTIPLIER=1.0
DIVIDER_WEIGHT=70
ROLEPLAY_WEIGHT=65
QUESTION_REP_THRESHOLD=3

# Entropy Detection
ENTROPY_ENABLED=true
SHANNON_THRESHOLD_LOW=3.5
SHANNON_THRESHOLD_HIGH=5.5
BIGRAM_ANOMALY_THRESHOLD=0.3

# Performance
TARGET_LATENCY_MS=50
CIRCUIT_BREAKER_ENABLED=true
CB_FAILURE_THRESHOLD=5
CB_RESET_TIMEOUT=30000