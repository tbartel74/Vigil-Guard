{
  "groups": [
    {
      "id": "quick",
      "label": "Quick Settings",
      "description": "Frequently used toggles and message",
      "order": 1
    },
    {
      "id": "detect",
      "label": "Detection Tuning",
      "description": "Scoring and bloom thresholds",
      "order": 2
    },
    {
      "id": "perf",
      "label": "Performance",
      "description": "Performance and limits",
      "order": 3
    },
    {
      "id": "adv",
      "label": "Advanced",
      "description": "Normalization, sanitization, whitelists",
      "order": 4
    },
    {
      "id": "pii",
      "label": "PII Detection",
      "description": "Personally identifiable information detection",
      "order": 5
    }
  ],
  "variables": [
    {
      "name": "BLOCK_MESSAGE",
      "groupId": "quick",
      "label": "Block Message",
      "type": "string",
      "required": true,
      "help": "Message shown to users when content is blocked",
      "default": "Content blocked by security policy. Please rephrase without instructing how to respond.",
      "map": [
        {
          "file": "unified_config.json",
          "path": "enforcement.block_message"
        }
      ]
    },
    {
      "name": "BLOOM_ROUTE_TO_AC",
      "groupId": "detect",
      "label": "Bloom route_to_ac_threshold",
      "type": "number",
      "required": true,
      "help": "Score (0-100) to trigger additional validation checks. Lower = more sensitive (default: 15)",
      "default": 15,
      "map": [
        {
          "file": "unified_config.json",
          "path": "bloom_decisions.route_to_ac_threshold"
        }
      ]
    },
    {
      "name": "BLOOM_HARD_BLOCK",
      "groupId": "detect",
      "label": "Bloom hard_block_threshold",
      "type": "number",
      "required": true,
      "help": "Score (0-100) to immediately block without further analysis. Higher = fewer false positives (default: 50)",
      "default": 50,
      "map": [
        {
          "file": "unified_config.json",
          "path": "bloom_decisions.hard_block_threshold"
        }
      ]
    },
    {
      "name": "BLOOM_REQUIRE_EXTRA",
      "groupId": "detect",
      "label": "Require additional signals",
      "type": "boolean",
      "required": true,
      "help": "Require multiple indicators before blocking. Reduces false positives (default: enabled)",
      "map": [
        {
          "file": "unified_config.json",
          "path": "bloom_decisions.require_zusatz_signals"
        }
      ],
      "default": true
    },
    {
      "name": "BLOOM_PHRASE_BONUS",
      "groupId": "detect",
      "label": "Bloom phrase match bonus",
      "type": "number",
      "required": true,
      "help": "Points added per matched phrase (0-100)",
      "default": 20,
      "map": [
        {
          "file": "unified_config.json",
          "path": "bloom_decisions.phrase_match_bonus"
        }
      ]
    },
    {
      "name": "BLOOM_M",
      "groupId": "perf",
      "label": "Bloom filter size (m)",
      "type": "number",
      "required": true,
      "help": "Bits allocated for bloom filter. Larger = fewer false positives, more memory (default: 32768)",
      "map": [
        {
          "file": "unified_config.json",
          "path": "bloom.m"
        }
      ],
      "default": 32768
    },
    {
      "name": "BLOOM_K",
      "groupId": "perf",
      "label": "Bloom hash functions (k)",
      "type": "number",
      "required": true,
      "help": "Number of hash functions. More = better accuracy, slower processing (default: 5)",
      "map": [
        {
          "file": "unified_config.json",
          "path": "bloom.k"
        }
      ],
      "default": 5
    },
    {
      "name": "REMOVE_ZERO_WIDTH",
      "groupId": "adv",
      "label": "Remove zero-width",
      "type": "boolean",
      "required": true,
      "help": "Strip invisible Unicode characters used for obfuscation. Recommended for security (default: enabled)",
      "map": [
        {
          "file": "unified_config.json",
          "path": "normalization.remove_zero_width"
        }
      ],
      "default": true
    },
    {
      "name": "COLLAPSE_WS",
      "groupId": "adv",
      "label": "Normalize spaces",
      "type": "boolean",
      "required": true,
      "help": "Merge multiple spaces/tabs/newlines. Prevents whitespace obfuscation (default: enabled)",
      "map": [
        {
          "file": "unified_config.json",
          "path": "normalization.collapse_whitespace"
        }
      ],
      "default": true
    },
    {
      "name": "DECODE_ENTITIES",
      "groupId": "adv",
      "label": "Decode HTML entities",
      "type": "boolean",
      "required": true,
      "help": "Convert HTML entities (&lt; to <). Essential for web input security (default: enabled)",
      "map": [
        {
          "file": "unified_config.json",
          "path": "normalization.decode_entities"
        }
      ],
      "default": true
    },
    {
      "name": "UNICODE_FORM",
      "groupId": "adv",
      "label": "Unicode normalization form",
      "type": "select",
      "required": true,
      "help": "NFC / NFD / NFKC / NFKD",
      "options": [
        {
          "value": "NFC",
          "label": "NFC - Basic composition"
        },
        {
          "value": "NFD",
          "label": "NFD - Basic decomposition"
        },
        {
          "value": "NFKC",
          "label": "NFKC - Aggressive composition (recommended)"
        },
        {
          "value": "NFKD",
          "label": "NFKD - Aggressive decomposition"
        }
      ],
      "map": [
        {
          "file": "unified_config.json",
          "path": "normalization.unicode_form"
        }
      ],
      "default": "NFKC"
    },
    {
      "name": "HEAVY_MAX_REMOVAL",
      "groupId": "adv",
      "label": "Heavy sanitization: max removal %",
      "type": "number",
      "required": true,
      "help": "Maximum percentage (0-100) of text removable during heavy sanitization (default: 60)",
      "map": [
        {
          "file": "unified_config.json",
          "path": "sanitization.heavy.max_removal_percent"
        }
      ],
      "default": 60
    },
    {
      "name": "HEAVY_POLICY",
      "groupId": "adv",
      "label": "Over-limit policy",
      "type": "select",
      "required": true,
      "help": "sanitize_if_exceeds | block_if_exceeds",
      "options": [
        {
          "value": "sanitize_if_exceeds",
          "label": "Continue sanitizing (recommended)"
        },
        {
          "value": "block_if_exceeds",
          "label": "Block if exceeds limit"
        }
      ],
      "map": [
        {
          "file": "unified_config.json",
          "path": "sanitization.heavy.policy"
        }
      ],
      "default": "sanitize_if_exceeds"
    },
    {
      "name": "NGRAM_MIN",
      "groupId": "adv",
      "label": "N-gram min",
      "type": "number",
      "required": true,
      "help": "Shortest substring length for pattern analysis. Smaller = more patterns caught (default: 3)",
      "map": [
        {
          "file": "unified_config.json",
          "path": "prefilter.ngram.min"
        }
      ],
      "default": 3
    },
    {
      "name": "NGRAM_MAX",
      "groupId": "adv",
      "label": "N-gram max",
      "type": "number",
      "required": true,
      "help": "Longest substring length for pattern analysis. Larger = longer patterns caught (default: 6)",
      "map": [
        {
          "file": "unified_config.json",
          "path": "prefilter.ngram.max"
        }
      ],
      "default": 6
    },
    {
      "name": "NGRAM_PREFIX_WINDOW",
      "groupId": "adv",
      "label": "N-gram prefix window",
      "type": "number",
      "required": true,
      "help": "Number of characters analyzed at input beginning for patterns (default: 96)",
      "map": [
        {
          "file": "unified_config.json",
          "path": "prefilter.ngram.prefix_window"
        }
      ],
      "default": 96
    },
    {
      "name": "PII_ENABLED",
      "groupId": "pii",
      "label": "Enable PII Detection",
      "type": "boolean",
      "required": true,
      "help": "Enable automatic redaction of personally identifiable information using Microsoft Presidio",
      "default": true,
      "map": [
        {
          "file": "unified_config.json",
          "path": "pii_detection.enabled"
        }
      ]
    },
    {
      "name": "PII_DETECTION_MODE",
      "groupId": "pii",
      "label": "Detection Mode",
      "type": "select",
      "required": true,
      "help": "Choose detection sensitivity profile based on your use case",
      "options": [
        {
          "value": "high_security",
          "label": "High Security (Banking, Healthcare)"
        },
        {
          "value": "balanced",
          "label": "Balanced (Recommended)"
        },
        {
          "value": "high_precision",
          "label": "High Precision (Low false positives)"
        }
      ],
      "default": "balanced",
      "map": [
        {
          "file": "unified_config.json",
          "path": "pii_detection.detection_mode"
        }
      ]
    },
    {
      "name": "PII_FALLBACK_TO_REGEX",
      "groupId": "pii",
      "label": "Fallback to Regex",
      "type": "boolean",
      "required": true,
      "help": "Use legacy regex patterns if Presidio API is offline or fails",
      "default": true,
      "map": [
        {
          "file": "unified_config.json",
          "path": "pii_detection.fallback_to_regex"
        }
      ]
    },
    {
      "name": "PII_CONTEXT_ENHANCEMENT",
      "groupId": "pii",
      "label": "Context Enhancement",
      "type": "boolean",
      "required": true,
      "help": "Analyze surrounding text for better accuracy (e.g., 'PESEL:' keyword before number)",
      "default": true,
      "map": [
        {
          "file": "unified_config.json",
          "path": "pii_detection.context_enhancement"
        }
      ]
    },
    {
      "name": "PII_API_TIMEOUT_MS",
      "groupId": "pii",
      "label": "API Timeout (ms)",
      "type": "number",
      "required": true,
      "help": "Request timeout for Presidio API in milliseconds (1000-10000)",
      "default": 3000,
      "map": [
        {
          "file": "unified_config.json",
          "path": "pii_detection.api_timeout_ms"
        }
      ]
    },
    {
      "name": "PII_REDACTION_MODE",
      "groupId": "pii",
      "label": "Redaction Mode",
      "type": "select",
      "required": true,
      "help": "How to redact detected PII: replace with token, hash, or mask",
      "options": [
        {
          "value": "replace",
          "label": "Replace ([EMAIL], [PESEL])"
        },
        {
          "value": "hash",
          "label": "Hash (SHA-256)"
        },
        {
          "value": "mask",
          "label": "Mask (****59)"
        }
      ],
      "default": "replace",
      "map": [
        {
          "file": "unified_config.json",
          "path": "pii_detection.redaction_mode"
        }
      ]
    }
  ]
}