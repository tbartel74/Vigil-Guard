# Vigil Guard Environment Configuration
# Copy this file to .env in the project root and customize the values

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# ⚠️  SECURITY WARNING - DO NOT USE THESE PASSWORDS IN PRODUCTION!
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#
# This file contains DEFAULT CREDENTIALS (admin123) that are:
# - PUBLICLY VISIBLE in the GitHub repository
# - KNOWN TO ATTACKERS worldwide
# - MUST BE CHANGED before deployment
#
# The install.sh script will AUTOMATICALLY:
# - Generate cryptographically secure random passwords
# - Replace all admin123 passwords with unique values
# - Display credentials ONCE (you must save them)
#
# If you see admin123 in your .env file:
# → RE-RUN: ./install.sh
# → OR manually generate: openssl rand -base64 32 | tr -d '/+=' | head -c 32
#
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# ============================================
# DOCKER NETWORK & CONTAINER NAMES
# ============================================
COMPOSE_PROJECT_NAME=vigil-guard

# Container names (used by install.sh and scripts)
CLICKHOUSE_CONTAINER_NAME=vigil-clickhouse
GRAFANA_CONTAINER_NAME=vigil-grafana
N8N_CONTAINER_NAME=vigil-n8n
BACKEND_CONTAINER_NAME=vigil-web-ui-backend
FRONTEND_CONTAINER_NAME=vigil-web-ui-frontend
CADDY_CONTAINER_NAME=vigil-caddy
PROMPT_GUARD_CONTAINER_NAME=vigil-prompt-guard-api

# ============================================
# WEB UI - BACKEND
# ============================================
BACKEND_PORT=8787
NODE_ENV=production
TARGET_DIR=/config
AUDIT_LOG_PATH=/app/audit.log

# JWT Authentication (CHANGE THIS!)
JWT_SECRET=change-this-to-a-secure-random-string-at-least-32-characters-long

# Session Secret (REQUIRED - install.sh auto-generates this)
SESSION_SECRET=change-this-to-a-secure-random-64-character-string

# Web UI Admin Password (install.sh auto-generates this)
# IMPORTANT: Do NOT use the default below - run ./install.sh to generate
WEB_UI_ADMIN_PASSWORD=CHANGE-ME-run-install-sh-to-generate-secure-password

# ============================================
# WEB UI - FRONTEND
# ============================================
FRONTEND_PORT=5173
VITE_API_BASE_URL=/api
VITE_GRAFANA_URL=http://localhost:3001

# ============================================
# CLICKHOUSE DATABASE
# ============================================
CLICKHOUSE_HTTP_PORT=8123
CLICKHOUSE_TCP_PORT=9000
CLICKHOUSE_HOST=vigil-clickhouse
CLICKHOUSE_USER=admin
CLICKHOUSE_PASSWORD=admin123
CLICKHOUSE_DB=n8n_logs

# ============================================
# GRAFANA
# ============================================
GRAFANA_PORT=3001
# Container user (default: 472:472 for Linux, override for macOS)
GRAFANA_UID=472
GRAFANA_GID=472
GF_SECURITY_ADMIN_USER=admin
GF_SECURITY_ADMIN_PASSWORD=admin123
GF_SECURITY_ALLOW_EMBEDDING=true
GF_SECURITY_COOKIE_SAMESITE=lax
GF_AUTH_ANONYMOUS_ENABLED=true
GF_AUTH_ANONYMOUS_ORG_ROLE=Viewer

# ============================================
# PRESIDIO PII DETECTION API
# ============================================
# Detection mode: high_security, balanced, high_precision
# - high_security: Banking/Healthcare (strict, accept false positives)
# - balanced: Most B2B apps (optimal precision/recall) - DEFAULT
# - high_precision: Chatbots/UX-critical (minimize false positives)
PII_DETECTION_MODE=balanced

# Context-aware detection (analyze surrounding text for keywords like 'PESEL:', 'email:')
# Improves accuracy by validating entities appear in PII-related contexts
# Recommended: true (disable for pure NER scoring without context boost)
PII_CONTEXT_ENHANCEMENT=true

# ============================================
# N8N WORKFLOW ENGINE
# ============================================
N8N_PORT=5678
# N8N uses account creation wizard on first visit (http://localhost:5678)
# No password pre-configuration required - set via wizard during initial setup
# N8N_BASIC_AUTH_ACTIVE=true
# N8N_BASIC_AUTH_USER=admin
# N8N_BASIC_AUTH_PASSWORD=<SET_VIA_WIZARD>

# ============================================
# PROMPT GUARD API
# ============================================
PROMPT_GUARD_PORT=8000
MODEL_PATH=/app/model

# ============================================
# CADDY REVERSE PROXY
# ============================================
CADDY_HTTP_PORT=80
CADDY_HTTPS_PORT=443
DOMAIN=localhost

# ============================================
# DATA DIRECTORIES
# ============================================
# All data will be stored in ./vigil_data/
# This is automatically created by install.sh

# ============================================
# SECURITY NOTES
# ============================================
# 1. CHANGE JWT_SECRET to a secure random string
# 2. CHANGE Web UI admin password (WEB_UI_ADMIN_PASSWORD)
# 3. CHANGE Grafana admin password in production
# 4. CHANGE n8n credentials in production
# 5. CHANGE ClickHouse password in production
# 6. Use HTTPS in production (configure Caddy)

# ============================================
# OPTIONAL CONFIGURATION
# ============================================

# Logging level (debug, info, warn, error)
LOG_LEVEL=info

# Maximum backup files to keep
MAX_BACKUPS=2

# Session timeout (in seconds)
SESSION_TIMEOUT=3600

# Enable debug mode (true/false)
DEBUG=false
